# 两个任务的框架



## 1 实验室参观

- 功能简述

使用action_manager实现，具有语音聊天，自动导航，到点播报等功能，整一个流程全部由语音控制。由于maptool插件生成的.xml程序无法读取（实验9无法复现），修改了action_manager读取导航点的方式。

更改action_manager后编译非常占用内存，建议编译前关掉其他进程，如果是虚拟机，多分配一点内存。

- 如何配置

~~~
cp action_manager.h ~/catkin_ws/src/wpb_home_apps/include
cp action_manager.cpp ~/catkin_ws/src/wpb_home_apps/src/action_manager
replace your own file with:
add_point.h add_point_test.cpp add_point.cpp
goto_point.h goto_point_test.cpp goto_point.cpp
add new file:
LabCruise.h LabCruise.cpp LabCruiseTest.cpp LabCruise.launch and modify your CMakeList.txt
~~~

~~~
cp AutoSaveAndTrans.cpp ~/Desktop
gcc AutoSaveAndTrans.cpp -o AutoSaveAndTrans
~~~

~~~
mkdir process_waypoints
cp process_waypoints.py ~/catkin_ws/src/process_waypoints
~~~

~~~
cp 519.mp3 /home/username
same for 520, 521
and modify strTarget in LabCruise.cpp
~~~

- 使用方法

1. 先建图

~~~
roslaunch wpb_home_apps add_point.launch 
~~~

建图的时候尽量靠着墙边走，不要轻易去开阔的地方。

建图完成后，输入

~~~
cd ~/Desktop
./AutoSaveAndTrans
~~~

之后可以取/home/user下的waypoints.txt里面，修改导航点的名字（第一列）。

2. 启动实验室参观流程

~~~
roslaunch wpb_home_apps LabCruise.launch
~~~

启动后，先说一句【你好小智】，小智会启动聊天功能，这时，可以问他，【你有哪些功能】、【你的家在哪里】等等，之后说【参观实验室】小智就会启动参观流程。

## 2 小智跑腿

- 功能简述

启动后，说一个导航点的名字，再说需要它做的功能【抓取、拍照，录视频、播放通知、三维重建】，机器人就会自动去往该点，做相应的行为后自动返回。

- 使用方法

~~~
roslaunch wpb_home_apps goto_point.launch
~~~

如果要进行【播放通知】功能，需要先录制.mp4格式的视频，放到/home/user下，命名为notice.mp4。

【抓取】功能等待机械臂实现。

新增了一个FilePath.h文件，记得去里面指定路径。

## 调试技巧
- 打印错误信息

在没有连线机器人时，调试，一般会出现很多Kinect未连接的报错，这就会导致自己写的打印错误信息的printf或者rosinfo得不到执行，解决方法是循环打印错误信息100次。
